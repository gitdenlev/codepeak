import V from"./u6-UTxcU.js";import{u as P,r as a,a as z,c as g,w as x,T as B,o as n,b as t,d as c,e as D,f as y,v as T,g as s,i as w,h as A,j as h,k as p,t as k,l as M,_ as R}from"./k_872zHB.js";import{u as j,a as b}from"./CRHgUGHx.js";const q={class:"mx-auto mt-40 p-4 flex flex-col items-center"},E={class:"mb-8 flex gap-2 items-center justify-center"},I={class:"flex flex-col gap-4 items-center"},U={class:"relative w-2/3 text-black/70"},H={class:"relative w-2/3 text-black/70"},J=["type"],O=["disabled"],F={key:0},G={key:1},K={key:0,class:"text-green-500 mt-2"},Q={key:1,class:"text-red-500 mt-2"},W={class:"text-center mt-6"},te={__name:"login",setup(X){P({title:"CodePeak - Login",link:[{rel:"icon",type:"image/svg+xml",href:"/logo.svg"}]});const r=a(!1),C=()=>{r.value=!r.value},v=a(""),{login:L,user:Y}=j(),i=a(""),l=a(""),d=a(""),u=a(!1),N=z(),S=async()=>{var m;try{u.value=!0;const e=await L({email:i.value,password:l.value});if(e&&e.success){const o=b("token",{maxAge:604800,path:"/"});o.value=e.token;const f=b("user",{maxAge:60*60*24*7,path:"/"});f.value=JSON.stringify(e.user),await N.push("/")}else d.value="Login failed. Please check your credentials."}catch(e){d.value=((m=e.data)==null?void 0:m.message)||"Login failed"}finally{u.value=!1}};return(m,e)=>{const o=V,f=R;return n(),g(B,{name:"fade",mode:"out-in"},{default:x(()=>[t("div",q,[t("div",E,[c(o,{name:"game-icons:mountaintop",size:"40"}),e[2]||(e[2]=t("h1",{class:"text-2xl"},"codepeak",-1))]),t("form",{onSubmit:D(S,["prevent"]),class:"w-full max-w-md"},[t("div",I,[t("div",U,[y(t("input",{"onUpdate:modelValue":e[0]||(e[0]=_=>w(i)?i.value=_:null),type:"email",placeholder:"Email address",required:"",class:"font-sans placeholder:font-kanit overflow-x-scroll pl-10 pr-4 py-2 rounded-md border-none outline-none border-gray-300 w-full"},null,512),[[T,s(i)]]),c(o,{name:"ic:twotone-alternate-email",size:"20",class:"absolute left-3 top-1/2 -translate-y-1/2"})]),t("div",H,[y(t("input",{"onUpdate:modelValue":e[1]||(e[1]=_=>w(l)?l.value=_:null),type:s(r)?"text":"password",placeholder:"Password",required:"",class:"font-sans placeholder:font-kanit overflow-x-scroll pl-10 pr-10 py-2 rounded-md border-none outline-none border-gray-300 w-full"},null,8,J),[[A,s(l)]]),c(o,{name:"mdi:password",size:"20",class:"absolute left-3 top-1/2 -translate-y-1/2"}),s(l).length>0?(n(),g(o,{key:0,onClick:C,name:s(r)?"lucide:eye":"basil:eye-closed-outline",size:"25",class:"cursor-pointer absolute right-3 top-1/2 -translate-y-1/2"},null,8,["name"])):h("",!0)]),t("button",{type:"submit",disabled:s(u),class:"border-none outline-none bg-blue-500 text-white py-2 rounded-md hover:bg-blue-600 transition duration-300 w-2/3"},[s(u)?(n(),p("span",F,"Loading...")):(n(),p("span",G,"Log In"))],8,O),s(v)?(n(),p("p",K,k(s(v)),1)):h("",!0),s(d)?(n(),p("p",Q,k(s(d)),1)):h("",!0)])],32),t("div",W,[c(f,{to:"/register",class:"text-blue-500 underline hover:text-blue-600"},{default:x(()=>e[3]||(e[3]=[M(" Don't have an account? Sign up here ")])),_:1})])])]),_:1})}}};export{te as default};
